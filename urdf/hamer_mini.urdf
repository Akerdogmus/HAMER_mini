<?xml version='1.0'?>
<robot name="hamer_mini">
	
	<!-- Dummy Link 
	<link name="dummy"/>
  	<joint name="dummy_joint" type="fixed">
     		<parent link="dummy"/>
     		<child link="base_link"/>
   	</joint> -->

	<!-- Base Link -->
	<link name="base_link">
	 	<visual>
		   <origin xyz="0 0 0" rpy="0 0 0" />
		   <geometry>
			<box size="0.255 0.150 0.04"/>
		   </geometry>
		   <material name="blue">
		      <color rgba="0 0.5 1 1"/>
		   </material>
		</visual>
		<!-- Base Collision -->
		<collision>
		   <origin xyz="0 0 0" rpy="0 0 0" />
		   <geometry>
			<box size="0.255 0.150 0.04"/>
		   </geometry>
		</collision>
		<!-- Base Inertial Elements -->
		<inertial>
		   <mass value="0.5"/>
		   <inertia ixx="0.002776" ixy="0.0" ixz="0.0"
			    iyy="0.003647" iyz="0.0" izz="0.001004"/>
		</inertial>
	</link>

	<!-- Right Back Wheel -->
	<link name="right_back_wheel">
	 	<visual>
		   <origin xyz="0 0 0" rpy="1.570795 0 0" />
		   <geometry>
			<cylinder length="0.026" radius="0.0325" />
		   </geometry>
		   <material name="black">
		      <color rgba="0.05 0.05 0.05 1"/>
		   </material>
		</visual>
		<!-- Right Back Wheel Collision -->
		<collision>
		   <origin xyz="0 0 0" rpy="1.570795 0 0" />
		   <geometry>
			<cylinder length="0.026" radius="0.0325" />
		   </geometry>
		</collision>
		<!-- Right Back Wheel Inertial Elements -->
		<inertial>
		   <mass value="0.01"/>
		   <inertia ixx="0.000003204" ixy="0.0" ixz="0.0"
			    iyy="0.000003204" iyz="0.0" izz="0.00005281"/>
		</inertial>
	</link>

	<joint name="joint_right_back_wheel" type="continuous">
	   <parent link="base_link"/>
	   <child link="right_back_wheel"/>
	   <origin xyz="-0.07 -0.086 0" rpy="0 0 0" />
	   <axis xyz="0 1 0"/>
	</joint>

	<!-- Right Front Wheel -->
	<link name="right_front_wheel">
	 	<visual>
		   <origin xyz="0 0 0" rpy="1.570795 0 0" />
		   <geometry>
			<cylinder length="0.026" radius="0.0325" />
		   </geometry>
		   <material name="black">
		      <color rgba="0.05 0.05 0.05 1"/>
		   </material>
		</visual>
		<!-- Right Front Wheel Collision -->
		<collision>
		   <origin xyz="0 0 0" rpy="1.570795 0 0" />
		   <geometry>
			<cylinder length="0.026" radius="0.0325" />
		   </geometry>
		</collision>
		<!-- Right Front Wheel Inertial Elements -->
		<inertial>
		   <mass value="0.01"/>
		   <inertia ixx="0.000003204" ixy="0.0" ixz="0.0"
			    iyy="0.000003204" iyz="0.0" izz="0.00005281"/>
		</inertial>
	</link>

	<joint name="joint_right_front_wheel" type="continuous">
	   <parent link="base_link"/>
	   <child link="right_front_wheel"/>
	   <origin xyz="0.07 -0.086 0" rpy="0 0 0" />
	   <axis xyz="0 1 0"/>
	</joint>

	<!-- Left Back Wheel -->
	<link name="left_back_wheel">
	 	<visual>
		   <origin xyz="0 0 0" rpy="1.570795 0 0" />
		   <geometry>
			<cylinder length="0.026" radius="0.0325" />
		   </geometry>
		   <material name="black">
		      <color rgba="0.05 0.05 0.05 1"/>
		   </material>
		</visual>
		<!-- Left Back Wheel Collision -->
		<collision>
		   <origin xyz="0 0 0" rpy="1.570795 0 0" />
		   <geometry>
			<cylinder length="0.026" radius="0.0325" />
		   </geometry>
		</collision>
		<!-- Left Back Wheel Inertial Elements -->
		<inertial>
		   <mass value="0.01"/>
		   <inertia ixx="0.000003204" ixy="0.0" ixz="0.0"
			    iyy="0.000003204" iyz="0.0" izz="0.00005281"/>
		</inertial>
	</link>

	<joint name="joint_left_back_wheel" type="continuous">
	   <parent link="base_link"/>
	   <child link="left_back_wheel"/>
	   <origin xyz="-0.07 0.086 0" rpy="0 0 0" />
	   <axis xyz="0 1 0"/>
	</joint>

	<!-- Left Front Wheel -->
	<link name="left_front_wheel">
	 	<visual>
		   <origin xyz="0 0 0" rpy="1.570795 0 0" />
		   <geometry>
			<cylinder length="0.026" radius="0.0325" />
		   </geometry>
		   <material name="black">
		      <color rgba="0.05 0.05 0.05 1"/>
		   </material>
		</visual>
		<!-- Left Front Wheel Collision -->
		<collision>
		   <origin xyz="0 0 0" rpy="1.570795 0 0" />
		   <geometry>
			<cylinder length="0.026" radius="0.0325" />
		   </geometry>
		</collision>
		<!--Left Front Wheel Inertial Elements -->
		<inertial>
		   <mass value="0.01"/>
		   <inertia ixx="0.000003204" ixy="0.0" ixz="0.0"
			    iyy="0.000003204" iyz="0.0" izz="0.00005281"/>
		</inertial>
	</link>

	<joint name="joint_left_front_wheel" type="continuous">
	   <parent link="base_link"/>
	   <child link="left_front_wheel"/>
	   <origin xyz="0.07 0.086 0" rpy="0 0 0" />
	   <axis xyz="0 1 0"/>
	</joint>

	<!-- Gazebo references -->
	<gazebo reference="base_link">
	   <material>Gazebo/Blue</material>
	</gazebo>
	<gazebo reference="right_front_wheel">
	   <material>Gazebo/Black</material>
	</gazebo>
	<gazebo reference="right_back_wheel">
	   <material>Gazebo/Black</material>
	</gazebo>
	<gazebo reference="left_front_wheel">
	   <material>Gazebo/Black</material>
	</gazebo>
	<gazebo reference="left_back_wheel">
	   <material>Gazebo/Black</material>
	</gazebo>

	<!-- Ultrasonic Sonar Sensors Links -->
	<!-- <link name="sonar_front">
		<collision>
			<origin xyz="0 0 0" rpy="0 0 0"/>
			<geometry>
				<box size="0.001 0.001 0.001"/>
			</geometry>
		</collision>
		<visual>
			<origin xyz="0 0 0" rpy="0 0 0"/>
			<geometry>
				<box size="0.001 0.001 0.001"/>
			</geometry>
		</visual> 
		<inertial>
			<mass value="1e-5" />
			<origin xyz="0 0 0" rpy="0 0 0"/>
			<inertia ixx="1e-6" ixy="0" ixz="0" iyy="1e-6" iyz="0" izz="1e-6" />
		</inertial>
	</link>

	<joint name="sonar_front_joint" type="fixed">
		<axis xyz="0 0 0" />
		<origin xyz="0.1275 0 0.01" rpy="0 0 0"/>
		<parent link="base_link"/>
		<child link="sonar_front"/>
	</joint> -->	

	 <link name="sonar_back">
		<collision>
			<origin xyz="0 0 0" rpy="0 0 0"/>
			<geometry>
				<box size="0.001 0.001 0.001"/>
			</geometry>
		</collision>
		<visual>
			<origin xyz="0 0 0" rpy="0 0 0"/>
			<geometry>
				<box size="0.001 0.001 0.001"/>
			</geometry>
		</visual> 
		<inertial>
			<mass value="1e-5" />
			<origin xyz="0 0 0" rpy="0 0 0"/>
			<inertia ixx="1e-6" ixy="0" ixz="0" iyy="1e-6" iyz="0" izz="1e-6" />
		</inertial>
	</link>

	<joint name="sonar_back_joint" type="fixed">
		<axis xyz="0 0 0" />
		<origin xyz="-0.1275 0 0.01" rpy="0 3.14 0"/>
		<parent link="base_link"/>
		<child link="sonar_back"/>
	</joint> 	

	<!-- Front-Left/Right Sonars -->
	<link name="sonar_left">
		<collision>
			<origin xyz="0 0 0" rpy="0 0 0"/>
			<geometry>
				<box size="0.001 0.001 0.001"/>
			</geometry>
		</collision>
		<visual>
			<origin xyz="0 0 0" rpy="0 0 0"/>
			<geometry>
				<box size="0.001 0.001 0.001"/>
			</geometry>
		</visual> 
		<inertial>
			<mass value="1e-5" />
			<origin xyz="0 0 0" rpy="0 0 0"/>
			<inertia ixx="1e-6" ixy="0" ixz="0" iyy="1e-6" iyz="0" izz="1e-6" />
		</inertial>
	</link>

	<joint name="sonar_left_joint" type="fixed">
		<axis xyz="0 0 0" />
		<origin xyz="0.1275 0.075 0.01" rpy="0 0 0.785"/>
		<parent link="base_link"/>
		<child link="sonar_left"/>
	</joint>	

	<link name="sonar_right">
		<collision>
			<origin xyz="0 0 0" rpy="0 0 0"/>
			<geometry>
				<box size="0.001 0.001 0.001"/>
			</geometry>
		</collision>
		<visual>
			<origin xyz="0 0 0" rpy="0 0 0"/>
			<geometry>
				<box size="0.001 0.001 0.001"/>
			</geometry>
		</visual> 
		<inertial>
			<mass value="1e-5" />
			<origin xyz="0 0 0" rpy="0 0 0"/>
			<inertia ixx="1e-6" ixy="0" ixz="0" iyy="1e-6" iyz="0" izz="1e-6" />
		</inertial>
	</link>

	<joint name="sonar_right_joint" type="fixed">
		<axis xyz="0 0 0" />
		<origin xyz="0.1275 -0.075 0.01" rpy="0 0 -0.785"/>
		<parent link="base_link"/>
		<child link="sonar_right"/>
	</joint>

	<!-- Ultrasonic Sonar Sensors Gazebo Ref. -->
	<gazebo reference="sonar_front">
		<material>Gazebo/Green</material>
		<sensor type="ray" name="sonar_front">
		  <pose>0 0 0 0 0 0</pose>
		  <update_rate>5</update_rate>
		  <ray>
		    <scan>
		      <horizontal>
		        <samples>5</samples>
		        <resolution>1.0</resolution>
		        <min_angle>-0.05</min_angle>
		        <max_angle>0.05</max_angle>
		      </horizontal>
		      <vertical>
		        <samples>5</samples>
		        <resolution>1</resolution>
		        <min_angle>-0.05</min_angle>
		        <max_angle>0.05</max_angle>
		      </vertical>
		    </scan>
		    <range>
		      <min>0.01</min>
		      <max>0.9</max>
		      <resolution>0.01</resolution>
		    </range>
		  </ray>
		  <plugin filename="libgazebo_ros_range.so" name="gazebo_ros_range">
		    <gaussianNoise>0.005</gaussianNoise>
		    <alwaysOn>true</alwaysOn>
		    <updateRate>5</updateRate>
		    <topicName>sonar_front</topicName>
		    <frameName>sonar_front</frameName>
		    <fov>0.8</fov>
		    <radiation>ultrasound</radiation>
		  </plugin>
		</sensor>
	</gazebo>

	<!-- Sonar Back -->
	<gazebo reference="sonar_back">
		<material>Gazebo/Green</material>
		<sensor type="ray" name="sonar_back">
		  <pose>0 0 0 0 0 0</pose>
		  <update_rate>5</update_rate>
		  <ray>
		    <scan>
		      <horizontal>
		        <samples>5</samples>
		        <resolution>1.0</resolution>
		        <min_angle>-0.05</min_angle>
		        <max_angle>0.05</max_angle>
		      </horizontal>
		      <vertical>
		        <samples>5</samples>
		        <resolution>1</resolution>
		        <min_angle>-0.05</min_angle>
		        <max_angle>0.05</max_angle>
		      </vertical>
		    </scan>
		    <range>
		      <min>0.01</min>
		      <max>0.9</max>
		      <resolution>0.01</resolution>
		    </range>
		  </ray>
		  <plugin filename="libgazebo_ros_range.so" name="gazebo_ros_range">
		    <gaussianNoise>0.005</gaussianNoise>
		    <alwaysOn>true</alwaysOn>
		    <updateRate>5</updateRate>
		    <topicName>sonar_back</topicName>
		    <frameName>sonar_back</frameName>
		    <fov>0.8</fov>
		    <radiation>ultrasound</radiation>
		  </plugin>
		</sensor>
	</gazebo> 
	
	
	<gazebo reference="sonar_left">
		<material>Gazebo/Green</material>
		<sensor type="ray" name="sonar_left">
		  <pose>0 0 0 0 0 0</pose>
		  <update_rate>5</update_rate>
		  <ray>
		    <scan>
		      <horizontal>
		        <samples>5</samples>
		        <resolution>1.0</resolution>
		        <min_angle>-0.2</min_angle>
		        <max_angle>0.2</max_angle>
		      </horizontal>
		      <vertical>
		        <samples>5</samples>
		        <resolution>1</resolution>
		        <min_angle>-0.05</min_angle>
		        <max_angle>0.05</max_angle>
		      </vertical>
		    </scan>
		    <range>
		      <min>0.01</min>
		      <max>0.9</max>
		      <resolution>0.01</resolution>
		    </range>
		  </ray>
		  <plugin filename="libgazebo_ros_range.so" name="gazebo_ros_range">
		    <gaussianNoise>0.005</gaussianNoise>
		    <alwaysOn>true</alwaysOn>
		    <updateRate>5</updateRate>
		    <topicName>sonar_left</topicName>
		    <frameName>sonar_left</frameName>
		    <fov>0.8</fov>
		    <radiation>ultrasound</radiation>
		  </plugin>
		</sensor>
	</gazebo>

	<gazebo reference="sonar_right">
		<material>Gazebo/Green</material>
		<sensor type="ray" name="sonar_right">
		  <pose>0 0 0 0 0 0</pose>
		  <update_rate>5</update_rate>
		  <ray>
		    <scan>
		      <horizontal>
		        <samples>5</samples>
		        <resolution>1.0</resolution>
		        <min_angle>-0.05</min_angle>
		        <max_angle>0.05</max_angle>
		      </horizontal>
		      <vertical>
		        <samples>5</samples>
		        <resolution>1</resolution>
		        <min_angle>-0.05</min_angle>
		        <max_angle>0.05</max_angle>
		      </vertical>
		    </scan>
		    <range>
		      <min>0.01</min>
		      <max>0.9</max>
		      <resolution>0.01</resolution>
		    </range>
		  </ray>
		  <plugin filename="libgazebo_ros_range.so" name="gazebo_ros_range">
		    <gaussianNoise>0.005</gaussianNoise>
		    <alwaysOn>true</alwaysOn>
		    <updateRate>5</updateRate>
		    <topicName>sonar_right</topicName>
		    <frameName>sonar_right</frameName>
		    <fov>0.8</fov>
		    <radiation>ultrasound</radiation>
		  </plugin>
		</sensor>
	</gazebo>

	<!-- Differential Drive Plugin 
	<gazebo>
	    <plugin name="differential_drive_controller"
		    filename="libgazebo_ros_diff_drive.so">
		<legacyMode>false</legacyMode>
		<alwaysOn>true</alwaysOn>
		<updateRate>1000.0</updateRate>
		<leftJoint>joint_left_back_wheel, joint_left_front_wheel</leftJoint>
		<rightJoint>joint_right_back_wheel, joint_right_front_wheel</rightJoint>
		<robotBaseFrame>base_link</robotBaseFrame>
		<wheelSeparation>0.25</wheelSeparation>
		<wheelDiameter>0.07</wheelDiameter>
		<publishWheelJointState>true</publishWheelJointState>
		<wheelDiameter>0.2</wheelDiameter>
		<wheelTorque>10</wheelTorque>
		<publishTf>1</publishTf>
		<odometryFrame>map</odometryFrame>
		<commandTopic>cmd_vel</commandTopic>
		<odometryTopic>odom</odometryTopic>
		<robotBaseFrame>base_link</robotBaseFrame>
		<wheelAcceleration>2.8</wheelAcceleration>
		<publishWheelJointState>true</publishWheelJointState>
		<publishWheelTF>false</publishWheelTF>
		<odometrySource>world</odometrySource>
		<rosDebugLevel>Debug</rosDebugLevel>
	     </plugin>
	</gazebo>  -->
 
	<!-- Gazebo ROS Control Plugin and Planar Move Plugin -->
	<gazebo>
		<plugin name="gazebo_ros_control" filename="libgazebo_ros_control.so">
			<robotNamespace>/hamer_mini</robotNamespace>
			<!--<robotSimType>gazebo_ros_control/DefaultRobotHWSim</robotSimType> -->
			<legacyModeNS>false</legacyModeNS>
		</plugin>
	</gazebo> 	

	<gazebo>
		<plugin name="base_controller" filename="libgazebo_ros_planar_move.so">
		    <commandTopic>cmd_vel</commandTopic>
		    <odometryTopic>odom</odometryTopic>
		    <odometryFrame>odom</odometryFrame>
		    <odometryRate>100</odometryRate>
		    <robotBaseFrame>base_link</robotBaseFrame>
		</plugin> 
	</gazebo> 

	<!-- Hokuyo Laser -->
	 	
	<link name="hokuyo_link">
	  <collision>
	    <origin xyz="0 0 0" rpy="0 0 0"/>
	    <geometry>
	  	<cylinder length="0.04" radius="0.02" />
	    </geometry>
	  </collision>
	  <visual>
	    <origin xyz="0 0 0" rpy="0 0 0"/>
	    <geometry>
	  	<cylinder length="0.04" radius="0.02" />
	    </geometry>
	  </visual>
	</link>

	<joint name="hokuyo_joint" type="fixed">
	  <axis xyz="0 1 0" />
	  <origin xyz="0.1 0 0.04" rpy="0 0 0"/>
	  <parent link="base_link"/>
	  <child link="hokuyo_link"/>
	</joint>	

	<gazebo reference="hokuyo_link">
	    <sensor type="ray" name="head_hokuyo_sensor">
	      <pose>0 0 0 0 0 0</pose>
	      <visualize>true</visualize>
	      <update_rate>40</update_rate>
	      <ray>
		<scan>
		  <horizontal>
		    <samples>720</samples>
		    <resolution>1</resolution>
		    <min_angle>-3.1416</min_angle>
		    <max_angle>3.1416</max_angle>
		  </horizontal>
		</scan>
		<range>
		  <min>0.10</min>
		  <max>30.0</max>
		  <resolution>0.01</resolution>
		</range>
		<noise>
		  <type>gaussian</type>
		  <mean>0.0</mean>
		  <stddev>0.01</stddev>
		</noise>
	      </ray>
	      <plugin name="gazebo_ros_head_hokuyo_controller" filename="libgazebo_ros_laser.so">
		<topicName>/hamer_mini/laser/scan</topicName>
		<frameName>hokuyo_link</frameName>
	      </plugin>
	    </sensor>
  	</gazebo>  

	<!-- Kinect Camera
	<link name="camera_link">
	 	<visual>
		   <origin rpy="1.570796 0 0" xyz="0 0 0"/>
		   <geometry>
		       <mesh filename="package://hamer_mini/meshes/Stl/Intel_RealSense_Depth_Camera_D435.stl" scale="0.00105 0.00105 0.00105"/>
		   </geometry>
	 	</visual>
	 	<collision>
			<origin xyz="0.0 0.0 0.0" rpy="0 0 0" />
			<geometry>
				<box size="0.0730 0.2760 0.0720"/>
	       		</geometry>
	 	</collision>
	 	<inertial>
			<mass value="0.170" />
			<origin xyz="0 0 0" />
			<inertia ixx="0.001152600" ixy="0.0" ixz="0.0"
				iyy="0.000148934" iyz="0.0"
				izz="0.001154654" />
	 		</inertial>
	</link>
	
	<joint name="camera_rgb_joint" type="fixed">
	 	<origin xyz="0.1275 0 0.03" rpy="0.0 0.0 0.0"/>
	 	<parent link="camera_link"/>
		<child link="camera_rgb_frame" />
	</joint>
	
	<gazebo reference="camera_link">
		<material>Gazebo/FlatBlack</material>
	</gazebo>
	
	<link name="camera_rgb_frame"/>
	
	<joint name="camera_rgb_optical_joint" type="fixed">
		<origin xyz="0.1275 0 0.03" rpy="-1.57079632679 0 -1.57079632679" />
		<parent link="camera_rgb_frame" />
	 	<child link="camera_rgb_optical_frame" />
	</joint>
	
	<link name="camera_rgb_optical_frame"/>
	
	<joint name="camera_joint" type="fixed">
		 <origin xyz="0.1275 0 0.03" rpy="0 0 1.5707969" />
		 <parent link="base_link"/>
		 <child link="camera_link"/>
	</joint>
	
	<joint name="camera_depth_joint" type="fixed">
		 <origin xyz="0.1275 0 0.03" rpy="0 0 0" />
	         <parent link="camera_link" />
	 	 <child link="camera_depth_frame" />
	</joint>
	
	<link name="camera_depth_frame"/>
		<joint name="camera_depth_optical_joint" type="fixed">
		 <origin xyz="0.1275 0 0.03" rpy="-1.57079632679 0 -1.57079632679" />
		 <parent link="camera_depth_frame" />
		 <child link="camera_depth_optical_frame" />
		</joint>
	
	<link name="camera_depth_optical_frame"/>

	<gazebo reference="camera_link">  
	 	<sensor type="depth" name="camera">
			<always_on>true</always_on>
			<update_rate>20.0</update_rate>
			<camera>
		 		<horizontal_fov>1.0471975512</horizontal_fov>
		 		<image>
					<format>R8G8B8</format>
					<width>640</width>
					<height>480</height>
		 		</image>
		 		<clip>
					<near>0.05</near>
					<far>8.0</far>
				</clip>
			</camera>
		
			<plugin name="kinect_camera_controller" filename="libgazebo_ros_openni_kinect.so">
		 		<robotNamespace>/hamer_mini</robotNamespace>
		 		<cameraName>camera</cameraName>
		 		<alwaysOn>true</alwaysOn>
		 		<updateRate>10</updateRate>
		 		<imageTopicName>rgb/image_raw</imageTopicName>
				 <depthImageTopicName>depth/image_raw</depthImageTopicName>
				 <pointCloudTopicName>depth/points</pointCloudTopicName>
				 <cameraInfoTopicName>rgb/camera_info</cameraInfoTopicName>
				 <depthImageCameraInfoTopicName>depth/camera_info</depthImageCameraInfoTopicName>
				 <frameName>camera_depth_optical_frame</frameName>
				 <baseline>0.1</baseline>
				 <pointCloudCutoff>0.4</pointCloudCutoff>
				 <distortionK1>0.00000001</distortionK1>
				 <distortionK2>0.00000001</distortionK2>
				 <distortionK3>0.00000001</distortionK3>
				 <distortionT1>0.00000001</distortionT1>
				 <distortionT2>0.00000001</distortionT2>
				 <CxPrime>0</CxPrime>
				 <Cx>0</Cx>
				 <Cy>0</Cy>
				 <focalLength>0</focalLength>
				 <hackBaseline>0</hackBaseline>
			</plugin>
	 	</sensor>
	</gazebo> -->
</robot> 
